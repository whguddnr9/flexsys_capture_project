<!-- 
    작성자 : 조형욱
    작성일 : 20210722

    목표 : canvas가 아닌 div를 이용한 상자 만들기.

    수정사항 :
    [20210722]  div를 이용한 시스템 구성 틀 작성
                div를 생성해서 상자 틀을 만든다. 
-->

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script  src="http://code.jquery.com/jquery-latest.min.js"></script>

<!--     <style>
        div{
            border: 1px solid black;
            text-align: center;
            position: absolute;
        }
        #test{
            border: 1px solid black;
            text-align: center;
            position: absolute;
        }
    </style> -->

    <style>
        body {
            margin: 0;
        }
        #move_Box {
            border: 1px solid black;
            text-align: center;
            position: absolute;
        }
        div{
            border: 1px solid black;
            text-align: center;
            position: absolute;
        }
        body.edit_cursor { cursor: crosshair; }
    </style>

</head>
<body>
    <button id="make" class = "div_btn">takeScreenShot</button>

</body>

<script>
    var $drag_box = document.createElement("div");
    $drag_box.id = "drag_box";
</script>
<script>
    
    
    //마우스 클릭 이벤트
    window.onload = function () {
        //버튼 눌렀을때 이벤트 등록
        document.getElementById("make").addEventListener("click", function (e) {
            document.querySelector("body").classList.add("edit_cursor");
            draw(e);
        }); 
    }
    //마우스 눌렀을때 상자가 있는지 없는지 확인할 이벤트
    function check(e) {

    }


    //상자 그리는 함수
    function draw(e) {
        var startX, startY;
        var height = window.innerHeight;
        var width = window.innerWidth;

        //영역을 표시할 div 객체
        var $createBox = document.createElement("div");

        var selectArea =false;
        
        $createBox.id = "move_Box";
        document.querySelector("body").appendChild($createBox);
        var body = document.querySelector('body');


        var mousedown = function(e){
            console.log("mousedown");
            //다른 이벤트들 무시해 기능이 중첩되지 않게
            e.preventDefault();
            selectArea = true;

            startX = e.clientX;
            startY = e.clientY;
            
            //같은 기능 중첩 방지
            body.removeEventListener("mousedown", mousedown);
        }
        
        body.addEventListener("mousedown", mousedown);

        var mouseup = function(e){
            console.log("mouseup");
            selectArea =false;

            body.removeEventListener("mousemove",mousemove);

            var x = e.clientX;
            var y = e.clientY;
            
            //그린 사각형의 크기 저장
            var top = Math.min(y, startY);
            var left = Math.min(x, startX);
            var width = Math.max(x, startX) - left;
            var height = Math.max(y, startY) - top;

            body.removeEventListener("mouseup", mouseup);
            // 마우스 커서 기본으로 변경 
        document.querySelector("body").classList.remove("edit_cursor");

        }
        body.addEventListener("mouseup", mouseup);

        var mousemove = function(e) {
            var x = e.clientX;
            var y = e.clientY;

            $createBox.style.left = x;
            $createBox.style.top = y;

            if(selectArea){
                var top = Math.min(y, startY);
                var right = width - Math.max(x, startX);
                var bottom = height - Math.max(y, startY);
                var left = Math.min(x, startX);
                $createBox.style.borderWidth = top + 'px ' + right + 'px ' + bottom + 'px ' + left + 'px';
            }
        }

    }
    //상자 옮기는 함수, 저장할 객체

    //div 삭제할 함수.

    //저장할 객체. 객체에서 함수를 불러와 그린다. 
    class Box {
        constructor(left,top,width,height){
        }
    }
</script>
</html>

<!-- 마우스를 눌렀을때 div로 창을 만들고, 마우스를 때면 그린 div객체를 삭제하고,
생성자를 이용해 객체를 만들어 마우스로 드래그 한 div 크기 그대로 다시 생성?

class 안에 method를 만들어 div 생성 코드 만들 것 

위치가 변경됬을 시? Box1.left = 11 이런식으로 변경?
-->